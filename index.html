<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>나의 대학생활 공간</title>
    <style>
        :root {
            --primary: #6667AB;
            --secondary: #F78CA0;
            --accent: #FFD166;
            --light: #F8F9FA;
            --dark: #212529;
            --success: #7FB069;
        }

        body.dark-mode {
            background-color: #121212;
            color: #f1f1f1;
        }
        body.dark-mode nav, body.dark-mode .card {
            background-color: #1e1e1e;
            color: #f1f1f1;
        }
        body.dark-mode .card-header {
            background: linear-gradient(135deg, #444, #666);
        }
        body.dark-mode a {
            color: #ffd166;
        }
        body.dark-mode nav ul li a:hover {
            background-color: #666;
            color: white;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }

        nav {
            background-color: white;
            padding: 1rem;
            border-radius: 50px;
            margin: 1rem auto;
            max-width: 80%;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            position: relative;
            z-index: 10;
        }

        nav ul {
            display: flex;
            justify-content: center;
            list-style: none;
        }

        nav ul li {
            margin: 0 15px;
        }

        nav ul li a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 600;
            transition: all 0.3s ease;
            padding: 8px 16px;
            border-radius: 20px;
        }

        nav ul li a:hover {
            background-color: var(--primary);
            color: white;
        }

        .card {
            background-color: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            transition: transform 0.3s ease;
            margin-bottom: 2rem;
        }

        .card-header {
            padding: 1rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .card-body {
            padding: 1rem;
        }

        .button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }

        .button:hover {
            background-color: var(--secondary);
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <!-- 네비게이션 및 다크 모드 버튼 -->
    <nav>
        <ul>
            <li><a href="#home">홈</a></li>
            <li><a href="#news">소식</a></li>
            <li><a href="#games">게임</a></li>
            <li><a href="#gallery">갤러리</a></li>
            <li><a href="#contact">연락처</a></li>
            <li>
                <button id="toggle-dark" class="button" style="padding: 6px 12px; font-size: 0.9rem;">🌙 다크모드</button>
            </li>
        </ul>
    </nav>

    <!-- 게임 시작 시 이름 입력 -->
    <section id="game-setup" class="card" style="max-width: 400px; margin: 2rem auto;">
        <div class="card-body" style="text-align: center;">
            <h3>게임 시작 전 이름을 입력하세요</h3>
            <input type="text" id="playerNameInput" placeholder="이름" style="padding: 8px; width: 80%; margin-bottom: 1rem;">
            <br>
            <button class="button" id="startGameBtn">게임 시작</button>
        </div>
    </section>

    <!-- 랭킹 섹션 -->
    <section id="ranking">
        <h2>게임 점수 랭킹</h2>
        <div class="card">
            <div class="card-body">
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="text-align: left;">
                            <th style="padding: 8px; border-bottom: 2px solid #ccc;">등수</th>
                            <th style="padding: 8px; border-bottom: 2px solid #ccc;">이름</th>
                            <th style="padding: 8px; border-bottom: 2px solid #ccc;">점수</th>
                        </tr>
                    </thead>
                    <tbody id="ranking-table"></tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- 테트리스 캔버스 -->
    <section id="tetris-section" class="card" style="max-width: 400px; margin: 2rem auto;">
        <div class="card-body" style="text-align: center;">
            <h3>테트리스</h3>
            <canvas id="tetris-canvas" width="200" height="400" style="border: 2px solid var(--primary);"></canvas>
            <div style="margin-top: 1rem;">
                <button class="button" id="start-tetris">게임 시작</button>
                <button class="button" id="pause-tetris">일시정지</button>
            </div>
        </div>
    </section>

    <script>
        const toggleBtn = document.getElementById('toggle-dark');
        toggleBtn.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            toggleBtn.textContent = document.body.classList.contains('dark-mode') ? '☀️ 라이트모드' : '🌙 다크모드';
        });

        let scores = [];
        let currentPlayer = '';

        const playerNameInput = document.getElementById('playerNameInput');
        const startGameBtn = document.getElementById('startGameBtn');

        const canvas = document.getElementById('tetris-canvas');
        const ctx = canvas.getContext('2d');
        const blockSize = 20;
        const cols = canvas.width / blockSize;
        const rows = canvas.height / blockSize;
        let board = [];
        let score = 0;
        let gameInterval;
        let currentPiece;
        let isGameOver = false;

        const pieces = [
            [[1, 1, 1, 1]],
            [[2, 2], [2, 2]],
            [[0, 3, 0], [3, 3, 3]],
            [[4, 0, 0], [4, 4, 4]],
            [[0, 0, 5], [5, 5, 5]]
        ];

        const colors = ['#FF0D72', '#0DC2FF', '#0DFF72', '#F538FF', '#FF8E0D'];

        function initBoard() {
            board = Array.from({ length: rows }, () => Array(cols).fill(0));
        }

        function drawBoard() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let y = 0; y < rows; y++) {
                for (let x = 0; x < cols; x++) {
                    if (board[y][x] !== 0) {
                        ctx.fillStyle = colors[board[y][x] - 1];
                        ctx.fillRect(x * blockSize, y * blockSize, blockSize, blockSize);
                        ctx.strokeStyle = '#333';
                        ctx.strokeRect(x * blockSize, y * blockSize, blockSize, blockSize);
                    }
                }
            }
        }

        function newPiece() {
            const index = Math.floor(Math.random() * pieces.length);
            currentPiece = {
                shape: pieces[index],
                x: Math.floor((cols - pieces[index][0].length) / 2),
                y: 0,
                type: index + 1
            };
        }

        function drawPiece() {
            const { shape, x, y, type } = currentPiece;
            shape.forEach((row, dy) => {
                row.forEach((val, dx) => {
                    if (val !== 0) {
                        ctx.fillStyle = colors[type - 1];
                        ctx.fillRect((x + dx) * blockSize, (y + dy) * blockSize, blockSize, blockSize);
                        ctx.strokeStyle = '#333';
                        ctx.strokeRect((x + dx) * blockSize, (y + dy) * blockSize, blockSize, blockSize);
                    }
                });
            });
        }

        function merge() {
            const { shape, x, y, type } = currentPiece;
            shape.forEach((row, dy) => {
                row.forEach((val, dx) => {
                    if (val !== 0) {
                        board[y + dy][x + dx] = type;
                    }
                });
            });
        }

        function collide() {
            const { shape, x, y } = currentPiece;
            return shape.some((row, dy) => {
                return row.some((val, dx) => {
                    if (val === 0) return false;
                    const newY = y + dy;
                    const newX = x + dx;
                    return (
                        newY >= rows ||
                        newX < 0 ||
                        newX >= cols ||
                        board[newY][newX] !== 0
                    );
                });
            });
        }

        function clearLines() {
            let lines = 0;
            board = board.filter(row => {
                if (row.every(cell => cell !== 0)) {
                    lines++;
                    return false;
                }
                return true;
            });
            while (board.length < rows) {
                board.unshift(Array(cols).fill(0));
            }
            score += lines * 100;
        }

        function drop() {
            currentPiece.y++;
            if (collide()) {
                currentPiece.y--;
                merge();
                clearLines();
                newPiece();
                if (collide()) {
                    endGame();
                }
            }
            drawBoard();
            drawPiece();
        }

        function endGame() {
            clearInterval(gameInterval);
            isGameOver = true;
            alert(`${currentPlayer}님의 게임 오버! 점수: ${score}`);
            scores.push({ name: currentPlayer, score });
            scores.sort((a, b) => b.score - a.score);
            renderRanking();
            document.getElementById('game-setup').style.display = 'block';
        }

        startGameBtn.addEventListener('click', () => {
            const name = playerNameInput.value.trim();
            if (!name) {
                alert('이름을 입력해주세요!');
                return;
            }
            currentPlayer = name;
            document.getElementById('game-setup').style.display = 'none';
            initBoard();
            newPiece();
            score = 0;
            isGameOver = false;
            drawBoard();
            gameInterval = setInterval(drop, 500);
        });

        function renderRanking() {
            const tbody = document.getElementById('ranking-table');
            tbody.innerHTML = '';
            scores.forEach((player, idx) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td style="padding: 8px; border-bottom: 1px solid #eee;">${idx + 1}</td>
                    <td style="padding: 8px; border-bottom: 1px solid #eee;">${player.name}</td>
                    <td style="padding: 8px; border-bottom: 1px solid #eee;">${player.score}</td>
                `;
                tbody.appendChild(row);
            });
        }
    </script>
</body>
</html>
